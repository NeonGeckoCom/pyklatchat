{% extends "components/conversation_wrapper.html" %}

{% block skin_body %}
    <div class="card non-selectable" id="{cid}">
        <div class="card-header"><span data-toggle="tooltip" title="{conversation_name}">{conversation_name_shrunk}</span>
            <div class="dropdown ml-3" id="participants-list-{cid}" data-toggle="tooltip" title='Subminds of "{conversation_name}"' style="display: inline!important;" >
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownToggle-{cid}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" onclick="renderActiveSubminds('{cid}')">
                    <i class="fa-solid fa-robot" aria-hidden="true"></i> <span id="participants-count-{cid}">0</span>
                </button>
                <div class="dropdown-menu dropdown-menu-right text-right" id="bot-list-{cid}">
                    <div class="d-flex justify-content-center align-items-center" style="height: 100px;" id="{cid}-subminds-state-loading">
                        <div class="spinner-border spinner-border-sm text-info" role="status"></div>
                        <span class="ml-2">Loading...</span>
                    </div>
                    <!-- Table displaying subminds -->
                    <table class="table table-sm" id="{cid}-subminds-state-table" style="display: none;">
                        <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col" class="text-center">Connected</th>
                            </tr>
                        </thead>
                        <tbody id="{cid}-subminds-state-entries">
                            <!-- Dynamic rows will be added here -->
                        </tbody>
                    </table>
                    <div id="{cid}-subminds-buttons" style="display: none; text-align: center;">
                        <button class="btn btn-danger btn-sm" id="{cid}-reset-button">Cancel</button>
                        <button class="btn btn-success btn-sm" id="{cid}-submit-button">Submit</button>
                    </div>
                </div>
            </div>
            <div class="dropdown language ml-2" data-toggle="tooltip" title="Language you Write" style="display: inline!important;">
                <button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="language-selected-{cid}-outcoming">
                    English <span class="flag-icon flag-icon-us" data-lang="en"></span>
                </button>
                <div class="dropdown-menu dropdown-menu-right text-right language" id="language-list-{cid}-outcoming">
                    <a class="dropdown-item lang-dropdown-header" disabled>Select Shout Language</a>
                    <div class="dropdown-divider"></div>
                    <div class="lang-container"></div>
                </div>
            </div>
            <div class="dropdown language ml-2" data-toggle="tooltip" title="Language you Read" style="display: inline!important;">
                <button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="language-selected-{cid}-incoming">
                    English <span class="flag-icon flag-icon-us" data-lang="en"></span>
                </button>
                <div class="dropdown-menu dropdown-menu-right text-right language" id="language-list-{cid}-incoming">
                    <a class="dropdown-item lang-dropdown-header" href="#">Select Receiving Language</a>
                    <div class="dropdown-divider"></div>
                    <div class="lang-container"></div>
                </div>
            </div>
            <div class="float-right">
                <div class="dropdown ml-1" data-toggle="tooltip" title="Display Format" style="display: inline!important;">
                    <button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="language-selected-{cid}-incoming">
                        <span class="fa fa-comments"></span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-right text-right">
                        <a class="dropdown-item" id="prompt-mode-{cid}">
                            Table Mode <span aria-hidden="true" class="fa fa-table-cells"></span>
                        </a>
                    </div>
                </div>
                <button type="button" id="close-{cid}" data-target-cid="{cid}" class="close-cid ml-1">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
        </div>
        <div class="card-body height3" style="overflow-y: auto; height: 450px!important;">
            <ul class="chat-list">
                {chat_flow}
            </ul>
        </div>
        <div class="card-footer">
            <textarea class="user_input form-control mb-2" id="{cid}-input" rows="1" cols="50"
                      placeholder='Write a Message to {conversation_name}'></textarea>
            <button class="send_user_input btn btn-success" id="{cid}-send" data-target-cid="{cid}">Send Message</button>
            <label for="file-input-{cid}" class="attachment-label">
              <i class="fa fa-paperclip fa-lg" aria-hidden="true"></i>
            </label>
            <input type="file" class="file-input fa fa-paperclip" data-target-cid="{cid}" style="display: none;" name="file-input" id="file-input-{cid}" multiple>
            <div class="filename-container" id="filename-container-{cid}" style="display: none"></div>
            <button class="btn btn-info rounded-circle float-right" id="{cid}-audio-input" data-toggle="tooltip" title="Record audio message">
                <i class="fa fa-microphone"></i>
            </button>
        </div>
    </div>
{% endblock %}
